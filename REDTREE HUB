local repo = 'https://raw.githubusercontent.com/deividcomsono/Obsidian/main/'

local Library = loadstring(game:HttpGet(repo .. 'Library.lua'))()
local ThemeManager = loadstring(game:HttpGet(repo .. 'addons/ThemeManager.lua'))()

local Options = Library.Options
local Toggles = Library.Toggles

local Window = Library:CreateWindow({
    Title = 'REDTREE HUB',
    Center = true,
    AutoShow = true,
    TabPadding = 4,
    MenuFadeTime = 0,
    ShowCustomCursor = false
})

local MainTab = Window:AddTab('Main')
local SettingsTab = Window:AddTab('Settings')

-- Movement
local MainBox = MainTab:AddLeftGroupbox('Movement')

-- WalkSpeed
Toggles.WalkSpeed = MainBox:AddToggle('WalkSpeed', {
    Text = 'WalkSpeed Boost',
    Default = false,
    Callback = function(state)
        getgenv().walkSpeedEnabled = state
        spawn(function()
            while getgenv().walkSpeedEnabled do
                task.wait()
                local hum = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("Humanoid")
                if hum then hum.WalkSpeed = 40 end
            end
            local hum = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("Humanoid")
            if hum then hum.WalkSpeed = 16 end
        end)
    end
})

-- Noclip
Toggles.Noclip = MainBox:AddToggle('Noclip', {
    Text = 'Noclip',
    Default = false,
    Callback = function(state)
        getgenv().noclipEnabled = state
        spawn(function()
            while getgenv().noclipEnabled do
                task.wait()
                local char = game.Players.LocalPlayer.Character
                if char then
                    for _, part in pairs(char:GetDescendants()) do
                        if part:IsA("BasePart") then part.CanCollide = false end
                    end
                end
            end
        end)
    end
})

-- AutoEat
Toggles.AutoEat = MainBox:AddToggle('AutoEat', {
    Text = 'Auto Eat Players',
    Default = false,
    Callback = function(state)
        getgenv().autoEat = state
        spawn(function()
            while getgenv().autoEat do
                task.wait()
                local char = game.Players.LocalPlayer.Character
                if not char or not char:FindFirstChild("Hitbox") then continue end
                for _, p in pairs(game.Players:GetPlayers()) do
                    if p ~= game.Players.LocalPlayer and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                        firetouchinterest(char.Hitbox, p.Character.HumanoidRootPart, 0)
                        firetouchinterest(char.Hitbox, p.Character.HumanoidRootPart, 1)
                    end
                end
            end
        end)
    end
})

-- AutoWin
Toggles.AutoWin = MainBox:AddToggle('AutoWin', {
    Text = 'Auto Win',
    Default = false,
    Callback = function(state)
        getgenv().autoWin = state
        spawn(function()
            while getgenv().autoWin do
                task.wait()
                local player = game.Players.LocalPlayer
                if not player.Character or player.Team ~= game.Teams.Runners then continue end
                local hrp = player.Character:FindFirstChild("HumanoidRootPart")
                if not hrp then continue end
                for _, exit in pairs(workspace.GameKeeper.Exits:GetChildren()) do
                    if exit.Name == "EscapeDoor" and exit:FindFirstChild("Root") then
                        firetouchinterest(hrp, exit.Root, 0)
                        firetouchinterest(hrp, exit.Root, 1)
                    end
                end
            end
        end)
    end
})

-- AutoCoin
Toggles.AutoCoin = MainBox:AddToggle('AutoCoin', {
    Text = 'Auto Collect Coins',
    Default = false,
    Callback = function(state)
        getgenv().autoCoin = state
        spawn(function()
            while getgenv().autoCoin do
                task.wait()
                local hrp = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                if not hrp then continue end
                for _, folder in pairs(workspace.GameKeeper.Map:GetChildren()) do
                    if folder.Name == "Tokens" then
                        for _, token in pairs(folder:GetChildren()) do
                            firetouchinterest(hrp, token, 0)
                            firetouchinterest(hrp, token, 1)
                        end
                    end
                end
            end
        end)
    end
})

-- AutoPower
Toggles.AutoPower = MainBox:AddToggle('AutoPower', {
    Text = 'Auto Collect Power',
    Default = false,
    Callback = function(state)
        getgenv().autoPower = state
        spawn(function()
            while getgenv().autoPower do
                task.wait()
                local hrp = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                if not hrp then continue end
                for _, folder in pairs(workspace.GameKeeper.Map:GetChildren()) do
                    if folder.Name == "Tokens" then
                        for _, item in pairs(folder:GetChildren()) do
                            if item:IsA("MeshPart") then
                                firetouchinterest(hrp, item, 0)
                                firetouchinterest(hrp, item, 1)
                            end
                        end
                    end
                end
            end
        end)
    end
})

-- Teleport
MainBox:AddButton({
    Text = 'Teleport to Safe Spot',
    Func = function()
        local player = game.Players.LocalPlayer
        local char = player.Character
        if not char then return end
        local hrp = char:FindFirstChild("HumanoidRootPart")
        if not hrp then return end

        local platform = Instance.new("Part")
        platform.Size = Vector3.new(20, 1, 20)
        platform.Anchored = true
        platform.Position = hrp.Position + Vector3.new(0, 50, 0)
        platform.Color = Color3.fromRGB(255, 255, 255)
        platform.Name = "SafePlatform"
        platform.Parent = workspace

        hrp.CFrame = CFrame.new(platform.Position + Vector3.new(0, 3, 0))
    end
})

-- Troll Banana
local TrollBox = MainTab:AddLeftGroupbox("Troll Banana")

Toggles.TrollBanana = TrollBox:AddToggle("Troll Banana", {
    Text = "Troll Banana",
    Default = false,
    Callback = function(state)
        getgenv().trollBanana = state
        spawn(function()
            while getgenv().trollBanana do
                task.wait(0.1)
                local bananas = {}
                for _, folder in pairs(workspace:WaitForChild("GameBananas"):GetChildren()) do
                    if folder.Name ~= "LobbyBananaAI" then
                        table.insert(bananas, folder)
                    end
                end

                if #bananas > 0 then
                    local bananaFolder = bananas[math.random(1, #bananas)]
                    local bananaName = bananaFolder.Name
                    local playerModel = workspace:FindFirstChild(bananaName)
                    if playerModel then
                        local hrp = playerModel:FindFirstChild("HumanoidRootPart") or playerModel:FindFirstChildWhichIsA("BasePart")
                        if hrp then
                            local distance = getgenv().bananaDistance or 5
                            local newPos = hrp.Position + (hrp.CFrame.LookVector * distance)
                            local plrHRP = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                            if plrHRP then
                                plrHRP.CFrame = CFrame.new(newPos, hrp.Position)
                            end
                        end
                    end
                end
            end
        end)
    end
})

TrollBox:AddSlider("Banana Distance", {
    Text = "Distance",
    Min = 5,
    Max = 100,
    Default = 5,
    Rounding = 1,
    Callback = function(value)
        getgenv().bananaDistance = value
    end
})


-- Extra Scripts
local ExtraBox = MainTab:AddLeftGroupbox('Extra')

ExtraBox:AddButton({
    Text = 'Infinite Yield',
    Func = function()
        loadstring(game:HttpGet('https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source', true))()
    end
})

ExtraBox:AddButton({
    Text = 'ESP',
    Func = function()
        loadstring(game:HttpGet('https://raw.githubusercontent.com/RedTree1222/scripts/refs/heads/main/esp', true))()
    end
})

ExtraBox:AddButton({
    Text = 'Banana Eats Script',
    Func = function()
        loadstring(game:HttpGet('https://raw.githubusercontent.com/RedTree1222/scripts/refs/heads/main/main%20(2).lua', true))()
    end
})

-- Misc Features (from linked script)
local MiscBox = MainTab:AddLeftGroupbox('Misc')

MiscBox:AddToggle('AntiAFK', {
    Text = 'Anti AFK',
    Default = true,
    Callback = function()
        game:GetService("Players").LocalPlayer.Idled:Connect(function()
            game:GetService("VirtualUser"):CaptureController()
            game:GetService("VirtualUser"):ClickButton1(Vector2.new())
            game:GetService("VirtualUser"):ClickButton2(Vector2.new())
        end)
    end
})

MiscBox:AddButton({
    Text = 'Claim Code',
    Func = function()
        game:GetService("Players").LocalPlayer.PlayerGui.CodeGui.Frame.Buttons.Input.Text = game:GetService("Workspace").GameProperties.SecretCode.Value
        wait(0.2)
        firesignal(game:GetService("Players").LocalPlayer.PlayerGui.CodeGui.Frame.Buttons.Redeem.MouseButton1Down)
    end
})

MiscBox:AddButton({
    Text = 'Gamepass 2x Chance',
    Func = function()
        game:GetService("Players").LocalPlayer.UserDataHolder.DoubledChances.Value = true
    end
})

MiscBox:AddButton({
    Text = 'Enable Reset',
    Func = function()
        game:GetService("StarterGui"):SetCore("ResetButtonCallback", true)
    end
})

MiscBox:AddButton({
    Text = 'Fullbright',
    Func = function()
        if not _G.FullBrightExecuted then
            _G.FullBrightEnabled = false
            _G.NormalLightingSettings = {
                Brightness = game:GetService("Lighting").Brightness,
                ClockTime = game:GetService("Lighting").ClockTime,
                FogEnd = game:GetService("Lighting").FogEnd,
                GlobalShadows = game:GetService("Lighting").GlobalShadows,
                Ambient = game:GetService("Lighting").Ambient
            }
            game:GetService("Lighting").Brightness = 1
            game:GetService("Lighting").ClockTime = 12
            game:GetService("Lighting").FogEnd = 786543
            game:GetService("Lighting").GlobalShadows = false
            game:GetService("Lighting").Ambient = Color3.fromRGB(178,178,178)
            _G.FullBrightExecuted = true
            _G.FullBrightEnabled = true
        else
            _G.FullBrightEnabled = not _G.FullBrightEnabled
        end
    end
})

MiscBox:AddToggle('AutoRemoveTrap', {
    Text = 'Auto Remove Trap',
    Default = false,
    Callback = function(state)
        getgenv().trap = state
        spawn(function()
            while getgenv().trap do
                task.wait()
                for _, v in pairs(game:GetService("Workspace").GameKeeper.Map:GetChildren()) do
                    if v.Name == "Peels" then
                        for _, j in pairs(v:GetChildren()) do
                            if j:IsA("Model") then j:Destroy() end
                        end
                    end
                end
            end
        end)
    end
})

-- Puzzle Automations
local PuzzleBox = MainTab:AddLeftGroupbox('Puzzles')

-- Auto Cake Puzzle
PuzzleBox:AddToggle('AutoCake', {
    Text = 'Auto Cake Puzzle',
    Default = false,
    Callback = function(state)
        getgenv().cake = state
        spawn(function()
            while getgenv().cake do
                task.wait()
                for _, v in pairs(game:GetService("Workspace").GameKeeper.Map:GetChildren()) do
                    if v.Name == "Items" then
                        for _, j in pairs(v:GetChildren()) do
                            if j.Name == "CakePlate" then
                                for _, c in pairs(j:GetDescendants()) do
                                    if c.ClassName == "ClickDetector" then
                                        fireclickdetector(c)
                                    end
                                end
                            end
                        end
                    end
                end
                for _, b in pairs(game:GetService("Workspace").GameKeeper.Puzzles:GetChildren()) do
                    if b.Name == "CakePuzzle" then
                        for _, c in pairs(b:GetChildren()) do
                            if c.Name == "Root" and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                                firetouchinterest(game.Players.LocalPlayer.Character.HumanoidRootPart, c, 0)
                                firetouchinterest(game.Players.LocalPlayer.Character.HumanoidRootPart, c, 1)
                            end
                        end
                    end
                end
            end
        end)
    end
})

-- Auto Combination Puzzle
PuzzleBox:AddToggle('AutoCombination', {
    Text = 'Auto Combination Puzzle',
    Default = false,
    Callback = function(state)
        getgenv().combi = state
        spawn(function()
            while getgenv().combi do
                task.wait()
                for _, v in pairs(game:GetService("Workspace").GameKeeper.Puzzles:GetChildren()) do
                    if v.Name == "CombinationPuzzle" then
                        for _, x in pairs(v:GetChildren()) do
                            if x.Name == "Buttons" then
                                for _, c in pairs(x:GetChildren()) do
                                    if c:FindFirstChild("ClickDetector") then
                                        fireclickdetector(c.ClickDetector)
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end)
    end
})

-- Auto Valve Puzzle
PuzzleBox:AddToggle('AutoValve', {
    Text = 'Auto Valve Puzzle',
    Default = false,
    Callback = function(state)
        getgenv().valve = state
        spawn(function()
            while getgenv().valve do
                task.wait()
                for _, v in pairs(game:GetService("Workspace").GameKeeper.Puzzles:GetChildren()) do
                    if v.Name == "ValvePuzzle" then
                        for _, c in pairs(v:GetDescendants()) do
                            if c:IsA("ClickDetector") then
                                fireclickdetector(c)
                            end
                        end
                    end
                end
            end
        end)
    end
})

-- Auto Picture Puzzle
PuzzleBox:AddToggle('AutoPicture', {
    Text = 'Auto Picture Puzzle',
    Default = false,
    Callback = function(state)
        getgenv().picture = state
        spawn(function()
            while getgenv().picture do
                task.wait(0.3)
                for _, v in pairs(game:GetService("Workspace").GameKeeper.Puzzles:GetChildren()) do
                    if v.Name == "PicturePuzzle" then
                        for _, x in pairs(v:GetChildren()) do
                            if x.Name == "Buttons" then
                                for _, c in pairs(x:GetChildren()) do
                                    if c.BrickColor ~= BrickColor.new("Camo") and c:FindFirstChild("ClickDetector") then
                                        fireclickdetector(c.ClickDetector)
                                    end
                                end
                            end
                        end
                    end
                end
            end
        end)
    end
})
