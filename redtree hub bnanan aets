-- Load Fluent UI
local Fluent = loadstring(
    game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua")
)()

-- Create Window
local Window = Fluent:CreateWindow({
    Title = "REDTREE HUB",
    SubTitle = "by RedTree",
    TabWidth = 160,
    Size = UDim2.fromOffset(580, 460),
    Acrylic = true,
    Theme = "Dark",
    MinimizeKey = nil -- IMPORTANT: no keybind (mobile safe)
})

-- Tabs
local Tabs = {
    Movement = Window:AddTab({ Title = "Movement", Icon = "" }),
    Extra = Window:AddTab({ Title = "Extra Scripts", Icon = "" }),
    Settings = Window:AddTab({ Title = "Settings", Icon = "settings" })
}

----------------------------------------------------
-- MOVEMENT
----------------------------------------------------

-- WalkSpeed
Tabs.Movement:AddToggle("WalkSpeed", {
    Title = "WalkSpeed Boost",
    Default = false,
    Callback = function(state)
        getgenv().ws = state

        task.spawn(function()
            while getgenv().ws do
                task.wait()
                local hum = game.Players.LocalPlayer.Character
                    and game.Players.LocalPlayer.Character:FindFirstChild("Humanoid")
                if hum then
                    hum.WalkSpeed = 40
                end
            end

            local hum = game.Players.LocalPlayer.Character
                and game.Players.LocalPlayer.Character:FindFirstChild("Humanoid")
            if hum then
                hum.WalkSpeed = 16
            end
        end)
    end
})

-- Noclip
Tabs.Movement:AddToggle("Noclip", {
    Title = "Noclip",
    Default = false,
    Callback = function(state)
        getgenv().noclip = state

        task.spawn(function()
            while getgenv().noclip do
                task.wait()
                local char = game.Players.LocalPlayer.Character
                if not char then continue end

                for _, v in pairs(char:GetDescendants()) do
                    if v:IsA("BasePart") then
                        v.CanCollide = false
                    end
                end
            end
        end)
    end
})

----------------------------------------------------
-- EXTRA SCRIPTS
----------------------------------------------------

Tabs.Extra:AddButton({
    Title = "Infinite Yield",
    Description = "Admin commands",
    Callback = function()
        loadstring(
            game:HttpGet("https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source", true)
        )()
    end
})

Tabs.Extra:AddButton({
    Title = "ESP",
    Description = "Player ESP",
    Callback = function()
        loadstring(
            game:HttpGet(
                "https://raw.githubusercontent.com/RedTree1222/scripts/refs/heads/main/esp",
                true
            )
        )()
    end
})

----------------------------------------------------
-- MOBILE FLOATING TOGGLE BUTTON
----------------------------------------------------

local UIS = game:GetService("UserInputService")
local PlayerGui = game.Players.LocalPlayer:WaitForChild("PlayerGui")

local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "RedTreeToggle"
ScreenGui.ResetOnSpawn = false
ScreenGui.Parent = PlayerGui

local Button = Instance.new("TextButton")
Button.Parent = ScreenGui
Button.Size = UDim2.fromOffset(42, 42)
Button.Position = UDim2.new(0, 10, 0.5, -21)
Button.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
Button.Text = "RT"
Button.TextSize = 18
Button.TextColor3 = Color3.new(1,1,1)
Button.Font = Enum.Font.GothamBold
Button.BorderSizePixel = 0
Button.Active = true
Button.ZIndex = 50

local corner = Instance.new("UICorner")
corner.CornerRadius = UDim.new(1, 0)
corner.Parent = Button

-- Toggle UI
local open = true
Button.MouseButton1Click:Connect(function()
    open = not open
    Window:SetVisible(open)
end)

-- Drag (mobile + PC)
local dragging = false
local dragStart, startPos

Button.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1
        or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = Button.Position
    end
end)

Button.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1
        or input.UserInputType == Enum.UserInputType.Touch then
        dragging = false
    end
end)

UIS.InputChanged:Connect(function(input)
    if dragging and
       (input.UserInputType == Enum.UserInputType.MouseMovement
        or input.UserInputType == Enum.UserInputType.Touch) then

        local delta = input.Position - dragStart
        Button.Position = UDim2.new(
            startPos.X.Scale,
            startPos.X.Offset + delta.X,
            startPos.Y.Scale,
            startPos.Y.Offset + delta.Y
        )
    end
end)
