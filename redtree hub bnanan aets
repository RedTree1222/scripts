local repo = 'https://raw.githubusercontent.com/deividcomsono/Obsidian/main/'

local Library = loadstring(game:HttpGet(repo .. 'Library.lua'))()
local ThemeManager = loadstring(game:HttpGet(repo .. 'addons/ThemeManager.lua'))()

local Options = Library.Options
local Toggles = Library.Toggles

local Window = Library:CreateWindow({
    Title = 'REDTREE HUB',
    Center = true,
    AutoShow = true,
    TabPadding = 4,
    MenuFadeTime = 0,
    ShowCustomCursor = false
})

local MainTab = Window:AddTab('Main')
local SettingsTab = Window:AddTab('Settings')

local MainBox = MainTab:AddLeftGroupbox('Movement')

-- WalkSpeed
Toggles.WalkSpeed = MainBox:AddToggle('WalkSpeed', {
    Text = 'WalkSpeed Boost',
    Default = false,
    Callback = function(state)
        getgenv().walkSpeedEnabled = state
        spawn(function()
            while getgenv().walkSpeedEnabled do
                task.wait()
                local hum = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("Humanoid")
                if hum then hum.WalkSpeed = 40 end
            end
            local hum = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("Humanoid")
            if hum then hum.WalkSpeed = 16 end
        end)
    end
})

-- Noclip
Toggles.Noclip = MainBox:AddToggle('Noclip', {
    Text = 'Noclip',
    Default = false,
    Callback = function(state)
        getgenv().noclipEnabled = state
        spawn(function()
            while getgenv().noclipEnabled do
                task.wait()
                local char = game.Players.LocalPlayer.Character
                if char then
                    for _, part in pairs(char:GetDescendants()) do
                        if part:IsA("BasePart") then part.CanCollide = false end
                    end
                end
            end
        end)
    end
})

-- AutoEat
Toggles.AutoEat = MainBox:AddToggle('AutoEat', {
    Text = 'Auto Eat Players',
    Default = false,
    Callback = function(state)
        getgenv().autoEat = state
        spawn(function()
            while getgenv().autoEat do
                task.wait()
                local char = game.Players.LocalPlayer.Character
                if not char or not char:FindFirstChild("Hitbox") then continue end
                for _, p in pairs(game.Players:GetPlayers()) do
                    if p ~= game.Players.LocalPlayer and p.Character and p.Character:FindFirstChild("HumanoidRootPart") then
                        firetouchinterest(char.Hitbox, p.Character.HumanoidRootPart, 0)
                        firetouchinterest(char.Hitbox, p.Character.HumanoidRootPart, 1)
                    end
                end
            end
        end)
    end
})

-- AutoWin
Toggles.AutoWin = MainBox:AddToggle('AutoWin', {
    Text = 'Auto Win',
    Default = false,
    Callback = function(state)
        getgenv().autoWin = state
        spawn(function()
            while getgenv().autoWin do
                task.wait()
                local player = game.Players.LocalPlayer
                if not player.Character or player.Team ~= game.Teams.Runners then continue end
                local hrp = player.Character:FindFirstChild("HumanoidRootPart")
                if not hrp then continue end
                for _, exit in pairs(workspace.GameKeeper.Exits:GetChildren()) do
                    if exit.Name == "EscapeDoor" and exit:FindFirstChild("Root") then
                        firetouchinterest(hrp, exit.Root, 0)
                        firetouchinterest(hrp, exit.Root, 1)
                    end
                end
            end
        end)
    end
})

-- AutoCoin
Toggles.AutoCoin = MainBox:AddToggle('AutoCoin', {
    Text = 'Auto Collect Coins',
    Default = false,
    Callback = function(state)
        getgenv().autoCoin = state
        spawn(function()
            while getgenv().autoCoin do
                task.wait()
                local hrp = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                if not hrp then continue end
                for _, folder in pairs(workspace.GameKeeper.Map:GetChildren()) do
                    if folder.Name == "Tokens" then
                        for _, token in pairs(folder:GetChildren()) do
                            firetouchinterest(hrp, token, 0)
                            firetouchinterest(hrp, token, 1)
                        end
                    end
                end
            end
        end)
    end
})

-- AutoPower
Toggles.AutoPower = MainBox:AddToggle('AutoPower', {
    Text = 'Auto Collect Power',
    Default = false,
    Callback = function(state)
        getgenv().autoPower = state
        spawn(function()
            while getgenv().autoPower do
                task.wait()
                local hrp = game.Players.LocalPlayer.Character and game.Players.LocalPlayer.Character:FindFirstChild("HumanoidRootPart")
                if not hrp then continue end
                for _, folder in pairs(workspace.GameKeeper.Map:GetChildren()) do
                    if folder.Name == "Tokens" then
                        for _, item in pairs(folder:GetChildren()) do
                            if item:IsA("MeshPart") then
                                firetouchinterest(hrp, item, 0)
                                firetouchinterest(hrp, item, 1)
                            end
                        end
                    end
                end
            end
        end)
    end
})

-- Teleport Safe Spot
MainBox:AddButton({
    Text = 'Teleport to Safe Spot',
    Func = function()
        local player = game.Players.LocalPlayer
        local char = player.Character
        if not char then return end
        local hrp = char:FindFirstChild("HumanoidRootPart")
        if not hrp then return end

        local platform = Instance.new("Part")
        platform.Size = Vector3.new(20, 1, 20)
        platform.Anchored = true
        platform.Position = hrp.Position + Vector3.new(0, 50, 0)
        platform.Color = Color3.fromRGB(255, 255, 255)
        platform.Name = "SafePlatform"
        platform.Parent = workspace

        hrp.CFrame = CFrame.new(platform.Position + Vector3.new(0, 3, 0))
    end
})

-- Extra Scripts
local ExtraBox = MainTab:AddLeftGroupbox('Extra')

ExtraBox:AddButton({
    Text = 'Infinite Yield',
    Func = function()
        loadstring(game:HttpGet('https://raw.githubusercontent.com/EdgeIY/infiniteyield/master/source', true))()
    end
})

ExtraBox:AddButton({
    Text = 'ESP',
    Func = function()
        loadstring(game:HttpGet('https://raw.githubusercontent.com/RedTree1222/scripts/refs/heads/main/esp', true))()
    end
})

ExtraBox:AddButton({
    Text = 'Banana Eats Script',
    Func = function()
        loadstring(game:HttpGet('https://raw.githubusercontent.com/RedTree1222/scripts/refs/heads/main/main%20(2).lua', true))()
    end
})

-- Big Hitbox toggle
Toggles.BigHitbox = MainBox:AddToggle("Big Hitbox", {
    Text = "Big Hitbox",
    Default = false,
    Callback = function(state)
        getgenv().bigHitboxEnabled = state
        spawn(function()
            while getgenv().bigHitboxEnabled do
                task.wait(5)
                for _, p in pairs(game.Players:GetPlayers()) do
                    if p.Name == "RedTree1222" or p.Name == "waaibro12" then continue end
                    local char = p.Character
                    if char then
                        for _, part in pairs(char:GetChildren()) do
                            if part:IsA("BasePart") then
                                part.Size = Vector3.new(100000, 100000, 100000)
                            end
                        end
                    end
                end
            end
        end)
    end
})

-- Troll Banana toggle
Toggles.TrollBanana = MainBox:AddToggle("Troll Banana", {
    Text = "Troll Banana",
    Default = false,
    Callback = function(state)
        getgenv().trollBananaEnabled = state
        spawn(function()
            while true do
                task.wait(0.1)
                if not getgenv().trollBananaEnabled then continue end
                local player = game.Players.LocalPlayer
                if not player.Character or not player.Character:FindFirstChild("HumanoidRootPart") then continue end
                local hrp = player.Character.HumanoidRootPart
                local bananasFolder = workspace:FindFirstChild("GameBananas")
                if not bananasFolder then continue end

                local validBananas = {}
                for _, banana in pairs(bananasFolder:GetChildren()) do
                    if banana.Name ~= "LobbyBananaAI" and (banana:IsA("Folder") or banana:IsA("Model")) then
                        table.insert(validBananas, banana)
                    end
                end

                if #validBananas == 0 then continue end

                local chosenBanana = validBananas[math.random(1, #validBananas)]
                local targetModel = workspace:FindFirstChild(chosenBanana.Name)
                if targetModel and targetModel:FindFirstChild("HumanoidRootPart") then
                    local bananaHRP = targetModel.HumanoidRootPart
                    local newPos = bananaHRP.Position + (bananaHRP.CFrame.LookVector * 10)
                    hrp.CFrame = CFrame.new(newPos, bananaHRP.Position)
                end
            end
        end)
    end
})
